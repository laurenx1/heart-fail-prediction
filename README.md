# heartFail
linear regression algorithm for heart failure prediction using Kaggle dataset

The purpose of this project was to create a machine learning model that could predict fatal heart failure based on 12 features, which were: age, anaemia, creatinine phosphokinase, diabetes, ejection fraction, high blood pressure, platelet count, serum creatinine, serum sodium, sex, smoking, and time between doctor appointments. This model used a dataset from Kaggle with 300 examples [1]. This algorithm used a Keras Sequential model in order to make these determinations and predictions.The findings of this report show that when only the features age, creatinine phosphokinase, ejection fraction, high blood pressure, serum creatinine, serum sodium, and smoking are used as features, the accuracy of the model increases from approximately 76% to 84%. This shows that these are the most necessary factors in predicting fatal heart failure. The application of this model is medical, specifically doctors and practices that focus on cardiology. This can be used as both a model that has determined the most important factors in heart failure, as well as a model that can predict a patient's probability of heart failure. 


Two patterns immediately stood out in the dataset, influencing the building of the model. First, platelet count. Because platelet count in relation to heart failure relies upon platelet function rather than count, it was deemed irrelevant to a death event. In the second model, with higher validation accuracy, platelet count was one feature taken out in order to improve the accuracy. Another pattern observed before building the model was the correlation between sex and serum creatinine. As mentioned under terms and definitions, healthy serum creatinine levels differ from male to female. So, it was hypothesized that if one is included, so must the other in order for the model to retain accuracy. However, this hypothesis was not confirmed by the accuracy reports of the model, so sex was taken out of model two while serum creatinine remained in the model, as it had a relatively high positive correlation with a death event. 

As recommended, time was taken out for clarity. 

Sex, anaemia, and diabetes were removed for low correlation. 

Age, creatinine phosphokinase, ejection fraction, serum creatinine, serum sodium were all included in model 2 because of their high correlation.

Although smoking had a low correlation, the impact of smoking on cardiovascular and respiratory health has been proven by multiple experts for decades. Smoking causes a buildup of fatty substances in the arteries, making it harder for the heart to pump blood. This excess strain weakens and damages the heart muscle. For this reason, smoking was kept in the model.

High blood pressure is a commonly known symptom of an unhealthy heart, making it relevant enough to remain a feature in model 2. However, high blood pressure is common, especially in the United States, so in the dataset, more people had high blood pressure than the set of people who died by a considerable amount, lowering its correlation to death despite being a factor. 

The final model (model 2) used the rectified linear activation (reLU) function with 3 nodes as the only hidden layer (a hidden layer is neuron nodes stacked between inputs and outputs, allowing models to learn complicated features). It is normally the default activation function for neural networks because it is easy to train and achieves better performance [16]. The sigmoid function is used as the output layer (1 node) in model 2. This is also a popular activation for neural networks. reLU will output the input directly if it is positive, otherwise, it will output zero. This means that it is a piecewise function: linear (identity) for positive values and 0 for all negative values. Because of this, it only activates some neurons at a time. This creates model sparsity that tends to overfit less. Overfitting was a major concern for this model, considering the dataset only has 300 examples. It also means that the outputs are only the meaningful inputs. Because this model has to make a decision of 0 or 1, the sigmoid function outputs a value between 0 and 1, with a threshold of 0.5. If the value is greater than or equal to 0.5, it outputs 1. This makes for a very smooth curve and simple derivative. It's the same as an action potential in biological neural networks, such as the human nervous system. 

This was an intuitive approach to constructing a multilayered keras Sequential model. To summarize, first the model eliminates all unimportant data, then makes a decision using a nonlinear function. This yielded the best results with a validation accuracy of 84%.
